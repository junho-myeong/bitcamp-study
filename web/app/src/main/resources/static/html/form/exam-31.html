<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>파일 업로드</title>
</head>
<body>
<h1>AJAX POST 요청 - 멀티파트 데이터 보내기</h1>


<!-- form에 액션을 주지 않으면 현재 url을 다시 서버에 요청한다 -->
<form id="form1">
  이름: <input type="text" name="name"><br>
  나이: <input type="text" name="age"><br>
  사진: <input type="file" name="photo"><br>
  <button type="button" id = "btn">요청</button>
</form>

<script>

var fName = document.querySelector('input[name="name"]')
var fAge = document.querySelector('input[name="age"]')


document.querySelector('#btn').addEventListener('click', function() {

  // 멀티파트형식으로 서버에 데이터를 보내려면 FormData 객체에 담아야한다.
  // 서버에 보낼 데이터를 FormData 객체에 보관한다.
  var fd = new FormData()
  fd.append("name", fName.value)
  fd.append("age", fAge.value)

  var xhr = new XMLHttpRequest();

  xhr.onreadystatechange = function(e) {
    if (xhr.readyState == 4){
      console.log("===>", xhr.responseText);
    }
  }

  xhr.open("post", "/html/form/exam31", true);

  // formdata 객체에 값을 담아서 보낼경우에는,
  // contentType은 디폴트가 multipart/form-data이다.
  xhr.send(fd)
  
  

});
</script>
  
</body>
</html>