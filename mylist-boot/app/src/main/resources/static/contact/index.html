<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>contact</title>
</head>
<body>
  <h1>연락처</h1>
  <a href="./form.html">새연락처</a>
  <table border="1" id="x-contact-Table">
    <!-- head 각 컬럼에 제목을 뜻한다.  컬럼에 제목은 head에 넣어 줘라!-->
    <thead>
      <!-- tr = table row 에 약자 행 을 뜻함 -->
      <tr>
        <th>이름</th>
        <th>이메일</th>
        <th>전화번호</th>
        <th>회사</th>
      </tr>
    </thead>
    <tbody>
        <!-- td = table data -->
    </tbody>
  </table>

  <script>
    var tbodyEl = document.querySelector('#x-contact-Table tbody')
    // var contacts = [
    //   "aaa1,aaa@test.com,1111,비트캠프",
    //   "aaa2,aaa@test.com,1111,비트캠프",
    //   "aaa3,aaa@test.com,1111,비트캠프",
    //   "aaa4,aaa@test.com,1111,비트캠프",
    //   "aaa5,aaa@test.com,1111,비트캠프"
    // ]
    fetch('/contact/list') // 이부분이 list라는 함수를 서버에 요청하는것이다.
    .then(function(response) { //요청 받은 데이터를 가져온다.
      // console.log(response) // 서버에서 받아 오는 값이 이상할때
      // if(!response.ok) {
      //   alert('서버 실행 오류!')
      //   return
      // }
      // json 문자열을 parse해서 js 객체로 다시 만들어 달라고 하는것이다.
      return response.json()
    })
    .then(function(contacts) {
      // 배열에 잇는거 모두 꺼낼땐 아래 방법 보다 위에 방법이 더 간단하다.
    for(var contact of contacts) {
      // console.log(contact)
      // console.log(contact.split(','))
      // split 함수는 배열을 리턴해준다.
      var values = contact.split(',')
      // console.log(values[0], values[1], values[2], values[3])
      var trEl = document.createElement('tr')
      trEl.innerHTML = `<td>${values[0]}</td><td>${values[1]}</td><td>${values[2]}</td><td>${values[3]}</td>`
      // console.log(trEl)
      tbodyEl.appendChild(trEl)
    }
    // 복습할때 이것도 해보고 강요천강사 방식으로도 해보기
    // for(var i = 0;i<contacts.length;i++) {
    //   console.log(contacts[i])
    // }
    })
  </script>
</body>
</html>